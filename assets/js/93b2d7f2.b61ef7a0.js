"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6678],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>d});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),i=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=i(e.components);return n.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),u=i(a),d=r,k=u["".concat(c,".").concat(d)]||u[d]||m[d]||o;return a?n.createElement(k,l(l({ref:t},s),{},{components:a})):n.createElement(k,l({ref:t},s))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=u;var p={};for(var c in t)hasOwnProperty.call(t,c)&&(p[c]=t[c]);p.originalType=e,p.mdxType="string"==typeof e?e:r,l[1]=p;for(var i=2;i<o;i++)l[i]=a[i];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},8537:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>i});var n=a(7462),r=(a(7294),a(3905));const o={sidebar_position:1},l="Object Memory Layout",p={unversionedId:"java/java-object-memory-layout",id:"java/java-object-memory-layout",title:"Object Memory Layout",description:"Object instance = new Object(); \u5728\u5185\u5b58\u4e2d\u5360\u7528\u591a\u5c11\u5b57\u8282\uff1f",source:"@site/docs/java/java-object-memory-layout.md",sourceDirName:"java",slug:"/java/java-object-memory-layout",permalink:"/code-works/docs/java/java-object-memory-layout",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/java/java-object-memory-layout.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Java",permalink:"/code-works/docs/category/java"}},c={},i=[],s={toc:i};function m(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},s,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"object-memory-layout"},"Object Memory Layout"),(0,r.kt)("p",null,"Object instance = new Object(); \u5728\u5185\u5b58\u4e2d\u5360\u7528\u591a\u5c11\u5b57\u8282\uff1f"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"new Object() \u5360\u752816\u5b57\u8282\uff0cinstance \u5360\u75284\u5b57\u8282")),(0,r.kt)("p",null,"\u5728HotSpot\u865a\u62df\u673a\u4e2d\uff0c\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u5e03\u5c40\u4e3a\u5bf9\u8c61\u5934\uff0c\u5b9e\u4f8b\u6570\u636e\u548c\u5bf9\u9f50\u586b\u5145\u4e09\u4e2a\u533a\u57df\uff0c\u5176\u4e2d\u5bf9\u8c61\u5934\u5305\u62ec MarkWork \u548c ClassPointer \u4e24\u90e8\u5206\u3002\u4e0b\u9762\u4e3b\u8981\u4ecb\u7ecd 64 \u4f4d JVM\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"New SSH key",src:a(7691).Z,width:"432",height:"412"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"MarkWork \u6807\u8bb0\u5b57\u6bb5\uff0c\u5360\u75288\u4e2a\u5b57\u8282\uff0c\u4e3b\u8981\u8bb0\u5f55\u9501\u72b6\u6001\uff08\u65e0\u9501\uff0c\u504f\u5411\u9501\uff0c\u8f7b\u91cf\u7ea7\u9501\uff0c\u91cd\u91cf\u7ea7\u9501\u6807\u8bc6\uff09\uff0chashCode, GC\u5206\u4ee3\u5e74\u9f84\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"ClassPointer \u7c7b\u6307\u9488\uff0c\u6307\u5411\u5bf9\u8c61\u7684Class\u7684\u5185\u5b58\u5730\u5740\u3002\u5185\u5b58\u5360\u7528\u662f\u9ed8\u8ba4\u5f00\u542f\u5b57\u8282\u538b\u7f29-XX:+UseCompressedClassPointers -XX:+UseCompressedOops, \u5f00\u542f\u65f6\u5360\u75284\u5b57\u8282\uff0c\u5173\u95ed\u65f6\u5360\u75288\u5b57\u8282\u3002"),(0,r.kt)("blockquote",{parentName:"li"},(0,r.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u5bf9\u8c61\u4e3a\u6570\u7ec4\u65f6\uff0c\u5bf9\u8c61\u5934\u8fd8\u5305\u62ec\u6570\u7ec4\u957f\u5ea6Length\uff0c\u5360\u75284\u4e2a\u5b57\u8282\u62168\u4e2a\u5b57\u8282\uff0c\u8bb0\u5f55\u6570\u7ec4\u957f\u5ea6\u3002"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"InstanceData \u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\uff0c\u5360\u7528\u7a7a\u95f4\u662f\u5bf9\u8c61\u6240\u6709\u6210\u5458\u53d8\u91cf\u6240\u5360\u7528\u7a7a\u95f4\u548c\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"padding \u5bf9\u9f50\u586b\u5145\uff0c\u8865\u9f50\u6574\u4f53\u5360\u7528\u7a7a\u95f4\u5927\u5c0f\u88ab8\u6574\u9664\uff0c\u56e0 HotSpot JVM \u7684\u81ea\u52a8\u5185\u5b58\u7ba1\u7406\u7cfb\u7edf\u8981\u6c42\u5bf9\u8c61\u8d77\u59cb\u5730\u5740\u5fc5\u987b\u662f8\u5b57\u8282\u7684\u6574\u6570\u500d\u3002"))),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"JOL"),"(JAVA OBJECT LAYOUT)\u5305\u53ef\u4ee5\u67e5\u770b\u4e00\u4e2a Java\u5bf9\u8c61\u7684\u5185\u5b58\u5e03\u5c40\u53ca\u5360\u7528\u591a\u5c11\u5b57\u8282"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"<dependency>\n    <groupId>org.openjdk.jol</groupId>\n    <artifactId>jol-core</artifactId>\n    <version>0.16</version>\n    <scope>provided</scope>\n</dependency>\n\n// \u6253\u5370 Java \u5bf9\u8c61\u5185\u5b58\u5e03\u5c40\nClassLayout.parseInstance(new Object()).toPrintable();\n\njava.lang.Object object internals:\n OFFSET  SIZE   TYPE DESCRIPTION        VALUE\n      0     4        (object header)    01 00 00 00 (00000001 00000000 00000000 00000000) (1)\n      4     4        (object header)    00 00 00 00 (00000000 00000000 00000000 00000000) (0)\n      8     4        (object header)    e5 01 00 f8 (11100101 00000001 00000000 11111000) (-134217243)\n     12     4        (loss due to the next object alignment)\nInstance size: 16 bytes\nSpace losses: 0 bytes internal + 4 bytes external = 4 bytes total\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"OFFSET"),":\u4ece\u7b2c\u51e0\u4e2a\u4f4d\u7f6e\u5f00\u59cb"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"size"),":\u5927\u5c0f\uff0c\u5355\u4f4d\u5b57\u8282\uff0c"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"TYPE DESCRIPTION"),"\uff1a\u7c7b\u578b\u63cf\u8ff0\uff0cobject header\u4e3a\u5bf9\u8c61\u5934\uff0c\u524d\u4e24\u884c\u4e3amarkwork\uff0c\u7b2c\u4e09\u884c\u4e3aclasspointer\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"VALUE"),"\uff1a\u503c"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"loss due to the next object alignment"),":\xa0 \u5bf9\u9f50\u586b\u5145")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u57fa\u7840\u7c7b\u578b\u5360\u7528\u7a7a\u95f4")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:"center"},"\u5360\u7528\uff08\u5b57\u8282\uff09"),(0,r.kt)("th",{parentName:"tr",align:"center"},"\u9ed8\u8ba4\u503c"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"byte"),(0,r.kt)("td",{parentName:"tr",align:"center"},"1"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"short"),(0,r.kt)("td",{parentName:"tr",align:"center"},"2"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"int"),(0,r.kt)("td",{parentName:"tr",align:"center"},"4"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"long"),(0,r.kt)("td",{parentName:"tr",align:"center"},"8"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0L")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"char"),(0,r.kt)("td",{parentName:"tr",align:"center"},"2"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"float"),(0,r.kt)("td",{parentName:"tr",align:"center"},"4"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0.0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"double"),(0,r.kt)("td",{parentName:"tr",align:"center"},"8"),(0,r.kt)("td",{parentName:"tr",align:"center"},"0.0d")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:"center"},"1"),(0,r.kt)("td",{parentName:"tr",align:"center"},"false")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Sample")),(0,r.kt)("p",null,"1.Integer[] \u5360\u7528\u5185\u5b58\u591a\u5c11\u5b57\u8282"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"markwork=8\u5b57\u8282\uff0cclasspointer\u5360\u75284\u5b57\u8282\uff0c\u6570\u7ec4\u957f\u5ea6\u5360\u75284\u5b57\u8282\uff0cInteger \u5185\u90e8int \u53d8\u91cfvalue\u5360\u75284\u5b57\u8282\uff0c\u5728\u586b\u51454\u5b57\u8282\u5bf9\u9f50\uff0c\u4e00\u5171\u5360\u752824\u5b57\u8282\u3002")))}m.isMDXComponent=!0},7691:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/java-object-memory-layout-30a12f99673cd7256ef898079b16cc02.png"}}]);